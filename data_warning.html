
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>A Word About Data, RAM, and Disk Space &#8212; ViSP_Pipeline v0.7.0</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400,600,700" type="text/css" />
    <link rel="stylesheet" href="_static/dkist.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="_static/favico.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reference/API" href="API.html" />
    <link rel="prev" title="Data Reduction Walkthrough" href="walkthrough.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="col-md-3 navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://nso.edu"><img src="_static/img/NSOlogo.gif">
        </a>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav hidden">
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">ViSP Pipeline Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="config_file.html">Configuration File Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="walkthrough.html">Data Reduction Walkthrough</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">A Word About Data, RAM, and Disk Space</a></li>
<li class="toctree-l1"><a class="reference internal" href="API.html">Reference/API</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">A Word About Data, RAM, and Disk Space</a><ul>
<li><a class="reference internal" href="#open-file-limit">Open File Limit</a></li>
<li><a class="reference internal" href="#ram-limit">RAM Limit</a></li>
<li><a class="reference internal" href="#disk-limit">Disk Limit</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="walkthrough.html" title="Previous Chapter: Data Reduction Walkthrough"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Data Reductio...</span>
    </a>
  </li>
  <li>
    <a href="API.html" title="Next Chapter: Reference/API"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Reference/API &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>
          
            <ul class="nav navbar-nav navbar-left">
              <li><a href="http://dkist.nso.edu/">DKIST</a></li>
              <li><a href="http://docs.cadair.com/devdocs">DC Developer Guide</a></li>
              <li><a href="http://docs.cadair.com/datarate">DKIST Data Rate</a></li>
              <li><a href="http://docs.cadair.com/datamodel">DKIST Data Model</a></li>
            </ul>
          
          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">

    <div class="col-md-3"><div id="side-logo" >
            <a href="http://dkist.nso.edu">
                <img src="_static/img/DKISTLogo-Medium.jpg">
            </a>
        </div><div id="sidebar" class="bs-sidenav" role="complementary">
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">ViSP Pipeline Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="config_file.html">Configuration File Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="walkthrough.html">Data Reduction Walkthrough</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">A Word About Data, RAM, and Disk Space</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#open-file-limit">Open File Limit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ram-limit">RAM Limit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#disk-limit">Disk Limit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="API.html">Reference/API</a></li>
</ul>

            
        </div>
    </div>

    <div class="col-md-9 content">
      
  <div class="section" id="a-word-about-data-ram-and-disk-space">
<span id="data-warning"></span><h1>A Word About Data, RAM, and Disk Space<a class="headerlink" href="#a-word-about-data-ram-and-disk-space" title="Permalink to this headline">¶</a></h1>
<p>If you are reducing large data volumes you may run into the limits of your system resources. This page describes the
3 constraints that may impact your ability to examine/play with the reduced data. <strong>NOTE:</strong> All of this only applies
to user interaction with the final, reduced data; the automated reduction pipeline is designed to avoid these limits.</p>
<div class="section" id="open-file-limit">
<h2>Open File Limit<a class="headerlink" href="#open-file-limit" title="Permalink to this headline">¶</a></h2>
<p>Your OS has a limit of how many files each process is allowed to be accessing at a single time. You can see the default
with</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">ulimit</span> -n
<span class="go">1024</span>
</pre></div>
</div>
<p>In this case the limit is 1024 open files. If you have more than 1024 slit positions and are trying to, for example,
extract a spatial map then your call to <code class="xref py py-obj docutils literal notranslate"><span class="pre">load_polarimetric_fitsData</span></code> will file with something like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">I</span><span class="o">.</span><span class="n">load_polarimetric_fitsData</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">,</span><span class="s1">&#39;Sci*.fits&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
  <span class="n">File</span> <span class="s2">&quot;/home/ade/PycharmProjects/ViSP_pipeline/ViSP_Pipeline/Data.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">139</span><span class="p">,</span> <span class="ow">in</span> <span class="n">load_polarimetric_fitsData</span>
  <span class="n">File</span> <span class="s2">&quot;/home/ade/PycharmProjects/ViSP_pipeline/ViSP_Pipeline/Data.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">40</span><span class="p">,</span> <span class="ow">in</span> <span class="fm">__init__</span>
  <span class="n">File</span> <span class="s2">&quot;/home/ade/PycharmProjects/ViSP_pipeline/ViSP_Pipeline/Data.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">62</span><span class="p">,</span> <span class="ow">in</span> <span class="n">load_from_file</span>
  <span class="n">File</span> <span class="s2">&quot;/usr/lib/python3.6/site-packages/astropy/io/fits/hdu/hdulist.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">166</span><span class="p">,</span> <span class="ow">in</span> <span class="n">fitsopen</span>
  <span class="n">File</span> <span class="s2">&quot;/usr/lib/python3.6/site-packages/astropy/io/fits/hdu/hdulist.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">402</span><span class="p">,</span> <span class="ow">in</span> <span class="n">fromfile</span>
  <span class="n">File</span> <span class="s2">&quot;/usr/lib/python3.6/site-packages/astropy/io/fits/hdu/hdulist.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">989</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_readfrom</span>
  <span class="n">File</span> <span class="s2">&quot;/usr/lib/python3.6/site-packages/astropy/utils/decorators.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">488</span><span class="p">,</span> <span class="ow">in</span> <span class="n">wrapper</span>
  <span class="n">File</span> <span class="s2">&quot;/usr/lib/python3.6/site-packages/astropy/io/fits/file.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">175</span><span class="p">,</span> <span class="ow">in</span> <span class="fm">__init__</span>
  <span class="n">File</span> <span class="s2">&quot;/usr/lib/python3.6/site-packages/astropy/io/fits/file.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">523</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_open_filename</span>
  <span class="n">File</span> <span class="s2">&quot;/usr/lib/python3.6/site-packages/astropy/io/fits/util.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">388</span><span class="p">,</span> <span class="ow">in</span> <span class="n">fileobj_open</span>
<span class="ne">OSError</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">24</span><span class="p">]</span> <span class="n">Too</span> <span class="n">many</span> <span class="nb">open</span> <span class="n">files</span><span class="p">:</span> <span class="s1">&#39;./Sci.1024.fits&#39;</span>
</pre></div>
</div>
<p>A simple solution to this problem is to just increase your OS’s open file limit:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">ulimit</span> -n <span class="m">2048</span>
<span class="gp">$</span> <span class="nb">ulimit</span> -n
<span class="go">2048</span>
</pre></div>
</div>
<p>Additionally, most of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code> classes’ load_data functions take the <code class="docutils literal notranslate"><span class="pre">max_open</span></code> keyword. This is used to control the
maximum number of open data files to keep. Once this number of files are loaded the data object will be flushed to disk
before more files are read.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Setting your OS limit to be exactly the number of data files you have will probably still result in errors at some
point. It’s good to leave overhead of a few hundred files just in case.</p>
</div>
</div>
<div class="section" id="ram-limit">
<h2>RAM Limit<a class="headerlink" href="#ram-limit" title="Permalink to this headline">¶</a></h2>
<p>The ViSP Pipeline uses <a class="reference external" href="http://docs.astropy.org/en/stable/io/fits/index.html#module-astropy.io.fits" title="(in Astropy v3.0.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a>’s <code class="xref py py-obj docutils literal notranslate"><span class="pre">memmap</span></code> to try to keep data out of RAM until it is needed, but sometimes
this can cause esoteric problems. Consider the following examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">Data</span><span class="o">.</span><span class="n">FitsData</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span><span class="o">.</span><span class="n">load_polarimetric_fitsData</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">,</span><span class="s1">&#39;Sci*.fits&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="n">max_open</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">data_hdus</span><span class="p">)</span>
<span class="go">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span><span class="o">.</span><span class="n">data_hdus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2160, 1280)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span><span class="o">.</span><span class="n">data_hdus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
  File <span class="nb">&quot;/usr/lib/python3.6/site-packages/astropy/utils/decorators.py&quot;</span>, line <span class="m">711</span>, in <span class="n">__get__</span>
    <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fget</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
  File <span class="nb">&quot;/usr/lib/python3.6/site-packages/astropy/io/fits/hdu/image.py&quot;</span>, line <span class="m">243</span>, in <span class="n">data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_scaled_image_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
  File <span class="nb">&quot;/usr/lib/python3.6/site-packages/astropy/io/fits/hdu/image.py&quot;</span>, line <span class="m">709</span>, in <span class="n">_get_scaled_image_data</span>
    <span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_raw_data</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
  File <span class="nb">&quot;/usr/lib/python3.6/site-packages/astropy/io/fits/hdu/base.py&quot;</span>, line <span class="m">475</span>, in <span class="n">_get_raw_data</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">readarray</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">code</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
  File <span class="nb">&quot;/usr/lib/python3.6/site-packages/astropy/io/fits/file.py&quot;</span>, line <span class="m">295</span>, in <span class="n">readarray</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
  File <span class="nb">&quot;/usr/lib/python3.6/site-packages/numpy/core/memmap.py&quot;</span>, line <span class="m">264</span>, in <span class="n">__new__</span>
    <span class="n">mm</span> <span class="o">=</span> <span class="n">mmap</span><span class="o">.</span><span class="n">mmap</span><span class="p">(</span><span class="n">fid</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">access</span><span class="o">=</span><span class="n">acc</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">start</span><span class="p">)</span>
<span class="gr">OSError</span>: <span class="n">[Errno 12] Cannot allocate memory</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span> <span class="o">=</span> <span class="n">Data</span><span class="o">.</span><span class="n">FitsData</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span><span class="o">.</span><span class="n">load_polarimetric_fitsData</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">,</span><span class="s1">&#39;Sci*.fits&#39;</span><span class="p">,</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="n">max_open</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">data_hdus</span><span class="p">)</span>
<span class="go">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span><span class="o">.</span><span class="n">data_hdus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
  File <span class="nb">&quot;/usr/lib/python3.6/site-packages/astropy/utils/decorators.py&quot;</span>, line <span class="m">711</span>, in <span class="n">__get__</span>
    <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fget</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
  File <span class="nb">&quot;/usr/lib/python3.6/site-packages/astropy/io/fits/hdu/image.py&quot;</span>, line <span class="m">243</span>, in <span class="n">data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_scaled_image_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
  File <span class="nb">&quot;/usr/lib/python3.6/site-packages/astropy/io/fits/hdu/image.py&quot;</span>, line <span class="m">709</span>, in <span class="n">_get_scaled_image_data</span>
    <span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_raw_data</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
  File <span class="nb">&quot;/usr/lib/python3.6/site-packages/astropy/io/fits/hdu/base.py&quot;</span>, line <span class="m">475</span>, in <span class="n">_get_raw_data</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">readarray</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">code</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
  File <span class="nb">&quot;/usr/lib/python3.6/site-packages/astropy/io/fits/file.py&quot;</span>, line <span class="m">295</span>, in <span class="n">readarray</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
  File <span class="nb">&quot;/usr/lib/python3.6/site-packages/numpy/core/memmap.py&quot;</span>, line <span class="m">264</span>, in <span class="n">__new__</span>
    <span class="n">mm</span> <span class="o">=</span> <span class="n">mmap</span><span class="o">.</span><span class="n">mmap</span><span class="p">(</span><span class="n">fid</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">access</span><span class="o">=</span><span class="n">acc</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">start</span><span class="p">)</span>
<span class="gr">OSError</span>: <span class="n">[Errno 12] Cannot allocate memory</span>
</pre></div>
</div>
<p>The problem in both cases is that the data cube was flushed to disk. In the first example we manually flushed it to
induce the error, and in the second example the data were flushed every 200 files. Before the first flush <code class="xref py py-obj docutils literal notranslate"><span class="pre">memmap</span></code> is
smartly keeping pointers to the individual data files, which are relatively small, but after a <code class="docutils literal notranslate"><span class="pre">flush()</span></code> <code class="xref py py-obj docutils literal notranslate"><span class="pre">memmap</span></code> is
pointing only to the single, flushed file and this file can get pretty big (1,000 slit positions is ~11 Gb). Now when
<code class="xref py py-obj docutils literal notranslate"><span class="pre">memmap</span></code> tries to access this file it first checks to make sure enough RAM is available to hold the entire thing <em>even
if the data won’t be loaded directly into RAM</em>. The above errors were thrown because the system in question did not have
enough RAM to (potentially) hold the whole, flushed data set.</p>
</div>
<div class="section" id="disk-limit">
<h2>Disk Limit<a class="headerlink" href="#disk-limit" title="Permalink to this headline">¶</a></h2>
<p>As mentioned above, a set of 1,000 reduced slit positions takes up about 11 Gb. Even if you have enough RAM to do a lot
of interactive analysis or extracting of maps you will generate a lot large files very quickly. Some of data handlers
automatically generate temporary files that stick around while your object is in use, so this build up might even
happen faster than you expect. Watch out! A semi-defense against rampant disk-usage is to pass <code class="docutils literal notranslate"><span class="pre">memmap=False</span></code> to any
of the data loading methods in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Data</span></code> classes.</p>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>Assuming you have plenty of cheap disk space then the real balancing act you need to manage is between the number of
open files and the amount of RAM on your system. More RAM lets you keep fewer files open, but comes at the expense of…
more RAM. Conversely, you might be tempted to just set your OS open file limit to some huge number and just go from
there. This is not a bad idea, but <code class="xref py py-obj docutils literal notranslate"><span class="pre">memmap</span></code> does a lot of tricky, behind the scenes stuff while reading and slicing
data, so you might find that even your hard limit (yes, this exists) of open files is not enough.</p>
<p>It is worth noting that <code class="xref py py-obj docutils literal notranslate"><span class="pre">memmap</span></code> doesn’t <em>necessarily</em> use all the RAM it looks for when loading a file. Thus, you might
be able to temporarily circumvent limits that prevent you from opening large files by just adding some swap-style RAM
to your system.</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <div class="left-footer">
         &copy; 2018, Arthur Eigenbrot
       <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a>
    </div>
   
    <div class="right-footer">
      Last updated on 21 Jun 2018.
    </div>
    <div class="centre-footer">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5
    </div>
  </div>
</footer>
  </body>
</html>